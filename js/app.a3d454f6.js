(function(e){function t(t){for(var r,c,o=t[0],s=t[1],u=t[2],m=0,b=[];m<o.length;m++)c=o[m],Object.prototype.hasOwnProperty.call(a,c)&&a[c]&&b.push(a[c][0]),a[c]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);l&&l(t);while(b.length)b.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,o=1;o<n.length;o++){var s=n[o];0!==a[s]&&(r=!1)}r&&(i.splice(t--,1),e=c(c.s=n[0]))}return e}var r={},a={app:0},i=[];function c(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=e,c.c=r,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)c.d(n,r,function(t){return e[t]}.bind(null,r));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],s=o.push.bind(o);o.push=t,o=o.slice();for(var u=0;u<o.length;u++)t(o[u]);var l=s;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"2a59":function(e,t,n){},"3a5b":function(e,t,n){"use strict";n("44fc")},"44fc":function(e,t,n){},"4f95":function(e,t,n){},"50c4b":function(e,t,n){"use strict";n("2a59")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("7a23");function a(e,t,n,a,i,c){var o=Object(r["k"])("the-processor");return Object(r["i"])(),Object(r["c"])(o,{style:{width:"100%",height:"100%"}})}var i={class:"horizontal-container"},c={class:"vertical-container control-container"},o={class:"horizontal-container button-container"},s={class:"program-container"},u={class:"vertical-container model-container"};function l(e,t,n,a,l,m){var b=Object(r["k"])("common-button"),d=Object(r["k"])("code-editor"),h=Object(r["k"])("tabs-container");return Object(r["i"])(),Object(r["d"])("div",i,[Object(r["e"])("div",c,[Object(r["e"])("div",o,[(Object(r["i"])(!0),Object(r["d"])(r["a"],null,Object(r["j"])(l.commonButtons,(function(e){return Object(r["i"])(),Object(r["c"])(b,{key:e,displayValue:e.display,function:e.function,disabled:e.disabled,class:"control-button"},null,8,["displayValue","function","disabled"])})),128))]),Object(r["e"])("div",s,[Object(r["f"])(d,{onRegisterCompiler:m.RegisterCompiler},null,8,["onRegisterCompiler"])])]),Object(r["e"])("div",u,[Object(r["f"])(h,{onRegisterMemory:m.RegisterMemory,instruction:l.instruction.instruction},null,8,["onRegisterMemory","instruction"])])])}var m=n("1da1"),b=(n("d3b7"),n("96cf"),["disabled"]);function d(e,t,n,a,i,c){return Object(r["i"])(),Object(r["d"])("button",{class:"common-button",disabled:n.disabled,onClick:t[0]||(t[0]=function(){return c.Click&&c.Click.apply(c,arguments)})},Object(r["m"])(n.displayValue),9,b)}var h={name:"CommonButton",props:{displayValue:{type:String,required:!0},function:{type:Function,required:!0},disabled:{type:Boolean,default:!1}},methods:{Click:function(){this.function()}}},f=(n("50c4b"),n("6b0d")),O=n.n(f);const p=O()(h,[["render",d]]);var v=p;function y(e,t,n,a,i,c){var o=Object(r["k"])("prism-editor");return Object(r["i"])(),Object(r["c"])(o,{class:"code-editor",modelValue:i.code,"onUpdate:modelValue":t[0]||(t[0]=function(e){return i.code=e}),highlight:c.HighlightCode,"line-numbers":""},null,8,["modelValue","highlight"])}var g=n("e57a"),j=(n("cabf"),n("8c7a")),k=n.n(j),C=(n("5792"),n("ac1f"),n("1276"),n("b0c0"),n("2ca0"),n("159b"),n("b64b"),n("d4ec")),x=n("ade3"),E=function e(t){Object(C["a"])(this,e),this.name=t};Object(x["a"])(E,"HALT",new E("HALT")),Object(x["a"])(E,"NEGATE",new E("NEGATE")),Object(x["a"])(E,"ACCDEC",new E("ACCDEC")),Object(x["a"])(E,"ACCINC",new E("ACCINC")),Object(x["a"])(E,"NOP",new E("NOP")),Object(x["a"])(E,"OUTP",new E("OUTP")),Object(x["a"])(E,"INP",new E("INP")),Object(x["a"])(E,"MLOAD",new E("MLOAD")),Object(x["a"])(E,"DLOAD",new E("DLOAD")),Object(x["a"])(E,"ILOAD",new E("ILOAD")),Object(x["a"])(E,"DSTORE",new E("DSTORE")),Object(x["a"])(E,"ISTORE",new E("ISTORE")),Object(x["a"])(E,"BRANCH",new E("BRANCH")),Object(x["a"])(E,"BRZERO",new E("BRZERO")),Object(x["a"])(E,"BRPOS",new E("BRPOS")),Object(x["a"])(E,"BRNEG",new E("BRNEG")),Object(x["a"])(E,"MADD",new E("MADD")),Object(x["a"])(E,"IJUMP",new E("IJUMP")),Object(x["a"])(E,"LABEL",new E("LABEL"));var R=0;function I(e,t){var n=e.split(/\s+/);R=0;while(n.length>0)A(n,t);t.push({instruction:"END"})}function A(e,t){var n=e.shift();switch(R++,n.toUpperCase()){case E.HALT.name:D(E.HALT.name,t);break;case E.NEGATE.name:D(E.NEGATE.name,t);break;case E.ACCDEC.name:D(E.ACCDEC.name,t);break;case E.ACCINC.name:D(E.ACCINC.name,t);break;case E.NOP.name:D(E.NOP.name,t);break;case E.OUTP.name:P(E.OUTP.name,e.shift(),t);break;case E.INP.name:P(E.INP.name,e.shift(),t);break;case E.MLOAD.name:L(E.MLOAD.name,e.shift(),t);break;case E.DLOAD.name:P(E.DLOAD.name,e.shift(),t);break;case E.ILOAD.name:P(E.ILOAD.name,e.shift(),t);break;case E.DSTORE.name:P(E.DSTORE.name,e.shift(),t);break;case E.ISTORE.name:P(E.ISTORE.name,e.shift(),t);break;case E.BRANCH.name:N(E.BRANCH.name,e.shift(),t);break;case E.BRZERO.name:N(E.BRZERO.name,e.shift(),t);break;case E.BRPOS.name:N(E.BRPOS.name,e.shift(),t);break;case E.BRNEG.name:N(E.BRNEG.name,e.shift(),t);break;case E.MADD.name:P(E.MADD.name,e.shift(),t);break;case E.IJUMP.name:P(E.IJUMP.name,e.shift(),t);break;case E.LABEL.name:N(E.LABEL.name,e.shift(),t);break;case"":break;default:throw Error("Unknown instruction at "+R)}}function D(e,t){t.push({instruction:e})}function P(e,t,n){if(!w(t))throw Error("Incorrect parameter format at instruction "+R+" ("+e+")");t=parseInt(t.substring(1)),n.push({instruction:e,address:t})}function L(e,t,n){if(!S(t))throw Error("Incorrect parameter format at instruction "+R+" ("+e+")");t=parseInt(t),n.push({instruction:e,value:t})}function N(e,t,n){if(B(t))throw Error("Label must not be keyword at instruction "+R+" ("+e+")");n.push({instruction:e,label:t})}function w(e){var t=e.startsWith("@");return t&&(e=e.substring(1),t=S(e)),t}function B(e){var t=!1;return Object.keys(E).forEach((function(n){n===e.toUpperCase()&&(t=!0)})),t}function S(e){return/^-?\d+$/.test(e)}var M={name:"CodeEditor",components:{PrismEditor:g["a"]},emits:["RegisterCompiler"],data:function(){return{code:"",instructionList:[],labelDict:{}}},created:function(){this.$emit("RegisterCompiler",{compile:this.CompileProgram,getInstruction:this.GetInstruction,getLabel:this.GetLabel})},methods:{HighlightCode:function(e){return k.a.languages.bp22={operator:/\b(?:HALT|NEGATE|ACCDEC|ACCINC|NOP|OUTP|INP|MLOAD|DLOAD|ILOAD|DSTORE|ISTORE|BRANCH|BRZERO|BRPOS|BRNEG|MADD|IJUMP|LABEL)\b/i},k.a.highlight(e,k.a.languages.bp22)},CompileProgram:function(){this.instructionList=[],this.labelDict={};try{I(this.code,this.instructionList)}catch(t){throw console.error(t),t}for(var e in this.instructionList)"LABEL"==this.instructionList[e].instruction&&(this.labelDict[this.instructionList[e].label]=parseInt(e));console.log(this.instructionList),console.log(this.labelDict)},GetInstruction:function(e){if(e<this.instructionList.length)return this.instructionList[e];throw RangeError("Invalid instruction address")},GetLabel:function(e){if(e in this.labelDict)return this.labelDict[e];throw RangeError("No such label")}}};n("951f");const T=O()(M,[["render",y]]);var _=T,H={class:"horizontal-container"};function U(e,t,n,a,i,c){var o=Object(r["k"])("common-button");return Object(r["i"])(),Object(r["d"])(r["a"],null,[Object(r["e"])("div",H,[Object(r["f"])(o,{displayValue:"RAM-Only Memory",function:function(){return c.ChangeCurrentTab("RamOnlyMemory")}},null,8,["function"]),Object(r["f"])(o,{displayValue:"Direct Cache",function:function(){return c.ChangeCurrentTab("")}},null,8,["function"]),Object(r["f"])(o,{displayValue:"Two-Way Cache",function:function(){return c.ChangeCurrentTab("")}},null,8,["function"]),Object(r["f"])(o,{displayValue:"Full Cache",function:function(){return c.ChangeCurrentTab("")}},null,8,["function"])]),(Object(r["i"])(),Object(r["c"])(Object(r["l"])(i.currentTab),{onRegisterMemory:c.RegisterMemory,instruction:n.instruction},null,8,["onRegisterMemory","instruction"]))],64)}function G(e,t,n,a,i,c){var o=Object(r["k"])("processor-model"),s=Object(r["k"])("ram-model");return Object(r["i"])(),Object(r["d"])(r["a"],null,[Object(r["f"])(o,{currentInstruction:n.instruction},null,8,["currentInstruction"]),Object(r["f"])(s,{data:i.ramData},null,8,["data"])],64)}var V={class:"vertical-container processor"},J=Object(r["e"])("div",null,"CPU",-1);function Z(e,t,n,a,i,c){return Object(r["i"])(),Object(r["d"])("div",V,[J,Object(r["e"])("div",null,"[ "+Object(r["m"])(n.currentInstruction)+" ]",1)])}var z={name:"ProcessorModel",props:{currentInstruction:{type:String,default:""}}};n("d529");const W=O()(z,[["render",Z]]);var $=W,q=(n("25f0"),{class:"ram"}),F={class:"ram-address"},K={class:"ram-value"};function Q(e,t,n,a,i,c){return Object(r["i"])(),Object(r["d"])("table",q,[(Object(r["i"])(!0),Object(r["d"])(r["a"],null,Object(r["j"])(n.data.length,(function(e){return Object(r["i"])(),Object(r["d"])("tr",{key:e},[Object(r["e"])("td",F,Object(r["m"])("0x"+(e-1).toString(16).toUpperCase()),1),Object(r["e"])("td",K,Object(r["m"])(n.data[e-1]),1)])})),128))])}var X={name:"RamModel",props:{data:{type:Array,required:!0}}};n("597e");const Y=O()(X,[["render",Q]]);var ee=Y,te={name:"RamOnlyMemory",components:{ProcessorModel:$,RamModel:ee},emits:["RegisterMemory"],props:{instruction:{type:String}},data:function(){return{ramData:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},created:function(){this.$emit("RegisterMemory",{write:this.Write,read:this.Read,reset:this.Reset})},methods:{Write:function(e,t){if(!(e<this.ramData.length&&e>=0))throw RangeError("Invalid memory address");this.ramData[e]=t},Read:function(e){if(e<this.ramData.length&&e>=0)return this.ramData[e];throw RangeError("Invalid memory address")},Reset:function(){this.ramData=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}}};const ne=O()(te,[["render",G]]);var re=ne,ae={name:"TabsContainer",components:{RamOnlyMemory:re,CommonButton:v},emits:["RegisterMemory"],props:{instruction:{type:String}},data:function(){return{currentTab:"RamOnlyMemory"}},methods:{ChangeCurrentTab:function(e){this.currentTab=e},RegisterMemory:function(e){this.$emit("RegisterMemory",e)}}};const ie=O()(ae,[["render",U]]);var ce=ie,oe=n("bee2"),se=function e(t){Object(C["a"])(this,e),this.name=t};Object(x["a"])(se,"NextInstruction",new se("NextInstruction")),Object(x["a"])(se,"HaltExecution",new se("HaltExecution")),Object(x["a"])(se,"EndExecution",new se("EndExecution")),Object(x["a"])(se,"MoveToLabel",new se("MoveToLabel")),Object(x["a"])(se,"MoveToAddress",new se("MoveToAddress"));var ue=function(){function e(t,n){Object(C["a"])(this,e),this.memory=t,this.acc=n}return Object(oe["a"])(e,[{key:"execute",value:function(e){var t;switch(e.instruction){case E.HALT.name:t=this._executeHalt();break;case E.NEGATE.name:t=this._executeNegate();break;case E.ACCDEC.name:t=this._executeAccdec();break;case E.ACCINC.name:t=this._executeAccinc();break;case E.NOP.name:t=this._executeNop();break;case E.OUTP.name:t=this._executeOutp();break;case E.INP.name:t=this._executeInp();break;case E.MLOAD.name:t=this._executeMload(e.value);break;case E.DLOAD.name:t=this._executeDload(e.address);break;case E.ILOAD.name:t=this._executeIload(e.address);break;case E.DSTORE.name:t=this._executeDstore(e.address);break;case E.ISTORE.name:t=this._executeIstore(e.address);break;case E.BRANCH.name:t=this._executeBranch(e.label);break;case E.BRZERO.name:t=this._executeBrzero(e.label);break;case E.BRPOS.name:t=this._executeBrpos(e.label);break;case E.BRNEG.name:t=this._executeBrneg(e.label);break;case E.MADD.name:t=this._executeMadd(e.address);break;case E.IJUMP.name:t=this._executeIjump(e.address);break;case E.LABEL.name:t=this._executeLabel();break;case"END":t=this._endExecution();break;default:throw Error("Unknown instruction")}return t}},{key:"_executeHalt",value:function(){return{result:se.HaltExecution}}},{key:"_executeNegate",value:function(){return this.acc.value=-this.acc.value,{result:se.NextInstruction}}},{key:"_executeAccdec",value:function(){return this.acc.value-=1,{result:se.NextInstruction}}},{key:"_executeAccinc",value:function(){return this.acc.value+=1,{result:se.NextInstruction}}},{key:"_executeNop",value:function(){return{result:se.NextInstruction}}},{key:"_executeOutp",value:function(){return{result:se.NextInstruction}}},{key:"_executeInp",value:function(){return{result:se.NextInstruction}}},{key:"_executeMload",value:function(e){return this.acc.value=e,{result:se.NextInstruction}}},{key:"_executeDload",value:function(e){return this.acc.value=this.memory.read(e),{result:se.NextInstruction}}},{key:"_executeIload",value:function(e){var t=this.memory.read(e);return this.acc.value=this.memory.read(t),{result:se.NextInstruction}}},{key:"_executeDstore",value:function(e){return this.memory.write(e,this.acc.value),{result:se.NextInstruction}}},{key:"_executeIstore",value:function(e){var t=this.memory.read(e);return this.memory.write(t,this.acc.value),{result:se.NextInstruction}}},{key:"_executeBranch",value:function(e){return{result:se.MoveToLabel,label:e}}},{key:"_executeBrzero",value:function(e){return 0==this.acc.value?{result:se.MoveToLabel,label:e}:{result:se.NextInstruction}}},{key:"_executeBrpos",value:function(e){return this.acc.value>0?{result:se.MoveToLabel,label:e}:{result:se.NextInstruction}}},{key:"_executeBrneg",value:function(e){return this.acc.value<0?{result:se.MoveToLabel,label:e}:{result:se.NextInstruction}}},{key:"_executeMadd",value:function(e){return this.acc.value+=this.memory.read(e),{result:se.NextInstruction}}},{key:"_executeIjump",value:function(e){var t=this.memory.read(e);return{result:se.MoveToAddress,address:t}}},{key:"_executeLabel",value:function(){return{result:se.NextInstruction}}},{key:"_endExecution",value:function(){return{result:se.EndExecution}}}]),e}(),le="notStarted",me="started",be="halted",de="ended",he={name:"TheLayout",components:{CommonButton:v,CodeEditor:_,TabsContainer:ce},data:function(){return{commonButtons:[{display:"|>",function:this.StartProgram,disabled:!1},{display:"|||",function:this.StopProgram,disabled:!0},{display:"||",function:this.PauseProgram,disabled:!0},{display:">",function:this.ExecuteInstruction,disabled:!0}],compiler:null,memory:null,cpu:null,currentState:le,instructionPointer:0,accumulator:{value:0},instruction:{instruction:""}}},methods:{StartProgram:function(){var e=this;return Object(m["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(console.log("Start program"),e.currentState==de&&e.ChangeSimulationState(le),e.currentState!=le){t.next=12;break}t.prev=3,e.compiler.compile(),t.next=11;break;case 7:return t.prev=7,t.t0=t["catch"](3),console.error("Compilation failed"),t.abrupt("return");case 11:e.cpu=new ue(e.memory,e.accumulator);case 12:e.ChangeSimulationState(me);case 13:if(e.currentState!=me){t.next=19;break}return e.ExecuteInstruction(),t.next=17,e.Sleep(500);case 17:t.next=13;break;case 19:case"end":return t.stop()}}),t,null,[[3,7]])})))()},StopProgram:function(){console.log("Stop program"),this.ChangeSimulationState(le)},PauseProgram:function(){console.log("Pause program"),this.ChangeSimulationState(be)},ExecuteInstruction:function(){try{this.instruction=this.compiler.getInstruction(this.instructionPointer);var e=this.cpu.execute(this.instruction);console.log(this.instruction),e.result==se.NextInstruction?this.instructionPointer++:e.result==se.MoveToLabel?this.instructionPointer=this.compiler.getLabel(e.label)+1:e.result==se.MoveToAddress?this.instructionPointer=e.address:e.result==se.HaltExecution?(console.log("Program halted"),this.instructionPointer++,this.ChangeSimulationState(be)):e.result==se.EndExecution&&(console.log("Program end"),this.ChangeSimulationState(de))}catch(t){console.error("Execution failed"),this.ChangeSimulationState(de)}},RegisterCompiler:function(e){this.compiler=e},RegisterMemory:function(e){this.memory=e},ChangeSimulationState:function(e){switch(e){case le:this.commonButtons[0].disabled=!1,this.commonButtons[1].disabled=!0,this.commonButtons[2].disabled=!0,this.commonButtons[3].disabled=!0,this.ResetState();break;case me:this.commonButtons[0].disabled=!0,this.commonButtons[1].disabled=!1,this.commonButtons[2].disabled=!1,this.commonButtons[3].disabled=!0;break;case be:this.commonButtons[0].disabled=!1,this.commonButtons[1].disabled=!1,this.commonButtons[2].disabled=!0,this.commonButtons[3].disabled=!1;break;case de:this.commonButtons[0].disabled=!1,this.commonButtons[1].disabled=!0,this.commonButtons[2].disabled=!0,this.commonButtons[3].disabled=!0;break}this.currentState=e},Sleep:function(e){return new Promise((function(t){setTimeout(t,e)}))},ResetState:function(){this.instructionPointer=0,this.accumulator={value:0},this.instruction={instruction:""},this.memory.reset()}}};n("f2ab");const fe=O()(he,[["render",l]]);var Oe=fe,pe={name:"App",components:{TheProcessor:Oe}};n("3a5b");const ve=O()(pe,[["render",a]]);var ye=ve;Object(r["b"])(ye).mount("#app")},"597e":function(e,t,n){"use strict";n("c0cd")},"8c5f":function(e,t,n){},9389:function(e,t,n){},"951f":function(e,t,n){"use strict";n("8c5f")},c0cd:function(e,t,n){},d529:function(e,t,n){"use strict";n("4f95")},f2ab:function(e,t,n){"use strict";n("9389")}});
//# sourceMappingURL=app.a3d454f6.js.map